\documentclass[12pt,a4paper]{article}
\usepackage{CJK}
\usepackage{enumerate}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{ctex}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{indentfirst}
%\usepackage[colorlinks,linkcolor=black]{hyperref}
\usepackage{geometry}
\usepackage{color}
\geometry{left=2.0cm,right=2.0cm,top=2.5cm,bottom=2.5cm}
%\hypersetup{CJKbookmarks=true}

\begin{document}
\begin{CJK*}{GBK}{song}
\pagenumbering{Roman}

\large
\title{\textbf{R.Brualdi《组合数学》(第五版)\\ 习题选解}}
\author{Alfred Sines\footnote{Department of Combinatorics, Cloud Society}}
\maketitle

\renewcommand{\contentsname}{\centerline{目录}}
\tableofcontents

\newpage
\pagenumbering{arabic}

\setlength{\parindent}{0pt}
\setlength{\parskip}{0.5em}
\section{什么是组合数学}

\par \textbf{11}. 用$Loub\grave{e}re$法构造7阶幻方.

\par 解：
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
30&39&48&1&10&19&28\\
\hline
38&47&7&9&18&27&29\\
\hline
46&6&8&17&26&35&37\\
\hline
5&14&16&25&34&36&45\\
\hline
13&15&24&33&42&44&4\\
\hline
21&23&32&41&43&3&12\\
\hline
22&31&40&49&2&11&20\\
\hline
\end{tabular}

\par \textbf{12}. 用$Loub\grave{e}re$法构造9阶幻方.
\par 解:
\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
\hline
47&58&69&80&1&12&23&34&45\\
\hline
57&68&79&9&11&22&33&44&46\\
\hline
67&78&8&10&21&32&43&54&56\\
\hline
77&7&18&20&31&42&53&55&66\\
\hline
6&17&19&30&41&52&63&65&76\\
\hline
16&27&29&40&51&62&64&75&5\\
\hline
26&28&39&50&61&72&74&4&15\\
\hline
36&38&49&60&71&73&3&14&25\\
\hline
37&48&59&70&81&2&13&24&35\\
\hline
\end{tabular}

\par \textbf{18}. 证明不存在2阶幻方体.
\par 证明: 假设存在2阶幻方体, 其幻和为9, 1相邻的三个位置均应为8, 矛盾.

\par \textbf{19}. 证明不存在4阶幻方体.
\par 证明: 假设存在4阶幻方体, 其幻和为130. 考虑任一$4*4$ 的平面截面(含过面对角线的截面), 其两条对角线之和及第二行、第三行之和为520, 减去第一、第四两列之和260, 得中间四个数之和的两倍为260, 中间四个数之和为130. 考虑中心$2*2*2$ 的子立方体, 其每个$2*2$ 平面截面(含过面对角线的截面)和为130, 从而其中每相邻两个数和都相等, 为65; 任一个数相邻的三个数相等, 矛盾.

\par \textbf{24}. 求构造$n$阶拉丁方的一般方法.
\par 解:
\begin{tabular}{|c|c|c|c|c|c|}
\hline
1&2&3&$\cdots$&n-1&n\\
\hline
n&1&2&$\cdots$&n-2&n-1\\
\hline
n-1&n&1&$\cdots$&n-3&n-2\\
\hline
$\cdots$&$\cdots$&$\cdots$&$\cdots$&$\cdots$&$\cdots$\\
\hline
3&4&5&$\cdots$&1&2\\
\hline
2&3&4&$\cdots$&n&1\\
\hline
\end{tabular}

\par \textbf{37}. $n$ 阶拉丁方是幂等的, 如果对角线位置$(1,1)(2,2)\cdots(n,n)$ 依次为$1,2,3,\cdots,n$; 它是对称的, 如果位置$(i,j)(j,i)$的整数总相等$(1\le i,j\le n, i\neq j)$. (1)构造一个3阶对称幂等拉丁方. (2) 证明偶数阶对称幂等拉丁方不存在.

\par 解:(1)
\begin{tabular}{|c|c|c|}
\hline
1&3&2\\
\hline
3&2&1\\
\hline
2&1&3\\
\hline
\end{tabular}
(2) 考虑1出现的次数, 其在对角线上出现1次, 对角线之外出现偶数次, 总共出现奇数次, 矛盾.

\section{排列与组合}

\par \textbf{40}. 设$S=\{1,2,3,\cdots,n\}$, 现取出其一个$k$元子集$A$, 要求$A$中任两个元素之差至少为$l+1$, 这样的子集有多少个?
\par 解: 记$A$中元素从小到大依次为$a_1,a_2,\cdots,a_k$, 令$b_1=a_1, b_2=a_2-a_1, b_3=a_3-a_2, \cdots, b_k=a_k-a_{k-1}, b_{k+1}=n-a_k$, 则$b_1+b_2+\cdots+b_k+b_{k+1}=n$, 其中$b_1\ge 1, b_i\ge l+1(2\le i\le k), b_{k+1}\ge 0$. 用变量替换法可知, 解的数目为$\binom{n-lk+l}{k}$.

\par \textbf{49}. 证明最多$m$个$A$和最多$n$ 个$B$的排列数为$\binom{m+n+2}{m+1}-1$.
\par 证明: $k$个$A$和$l$个$B$的排列数为$\binom{k+l}{k}$, 对$l$从0到$n$求和, 得$k$ 个$A$和最多$n$个$B$的排列数为$\binom{k+n+1}{n}$. 对$k$从0到$m$求和, 得$\binom{m+n+2}{n+1}-1$(包含了空排列).

\section{鸽巢原理}
\par \textbf{9}. 集合$S$中有10个正整数, 它们均不超过60. 证明存在$S$的两个不交非空子集, 它们的元素之和相同.
\par 证明: $S$有1023个非空子集, 它们的元素和在1到600之间, 由鸽巢原理, 必有两个子集$A,B$ 的元素和相同. 则$A\setminus B,B\setminus A$ 即为所求.
\par 推广: 设集合$S$中有$k$个正整数, 它们均不超过$n$; 且不存在$S$ 的两个不交非空子集, 它们的元素之和相同. 求$k=f(n)$之最大值.
\par 评注: $6\le f(60)\le 8$. 事实上, $S=\{1,2,4,8,16,32\}$ 符合要求. 若$|S|\ge 10$, 由本题证法得不符合要求. 若$|S|=9$, 考虑其所有不超过四元的非空子集, 共255个, 而其元素和均不超过240.

\par \textbf{13}. 对$K_6$的边做红蓝二着色, 证明: 必存在至少两个同色$K_3$.
\par 证明: 设$K_6$的6个顶点为$a,b,c,d,e,f$.
\par (1) 若$a$引出的5条边有4条同色, 不妨$\textcolor{red}{ab},\textcolor{red}{ac},
\textcolor{red}{ad},\textcolor{red}{ae}$全为红色, 则$b,c,d,e$之间的边若有两条为红色, 即得两个红色$K_3$; 若全为蓝色, $bcde$为蓝色$K_4$, 包含两个蓝色$K_3$; 若恰有一边红色, 不妨为$\textcolor{red}{bc}$, 则$abc$为红色$K_3$, $cde$为蓝色$K_3$.
\par (2) 若$a$引出的5条边至多有3条同色, 不妨$\textcolor{red}{ab},\textcolor{red}{ac},\textcolor{red}{ad} $为红色, $\textcolor{blue}{ae},\textcolor{blue}{af}$为蓝色. 此时$abcd$中至少有一个同色$K_3$, 若$\textcolor{blue}{ef}$为蓝色, 则已得两个同色$K_3$. 下设$\textcolor{red}{ef}$为红色.
\par (2a) 若$bcd$中至少两条红边, 已得两个红色$K_3$;
\par (2b) 若$bcd$中恰有一条红边, 设$\textcolor{red}{bc}$为红色, $\textcolor{blue}{bd},
\textcolor{blue}{cd}$为蓝色, 则已有$abc$为红色$K_3$. 若$\textcolor{red}{de}$为蓝色, 则可设
$\textcolor{blue}{df}$为蓝色 (否则$def$为红色$K_3$), 又可设$\textcolor{red}{bf}$为红色(否则$bdf$为蓝色$K_3$), 则不论$cf$为什么颜色, 都得到另一个同色$K_3$ (红色$bcf$或蓝色$cdf$).
若$\textcolor{blue}{de}$为蓝色, 则可设
$\textcolor{red}{be}$为红色(否则$bde$为蓝色$K_3$), 则不论$ce$为什么颜色, 都得到另一个同色$K_3$ (红色$bce$或蓝色$cde$).
\par (2c) 若$bcd$中没有红边, 即$\textcolor{blue}{bc},\textcolor{blue}{bd},
\textcolor{blue}{cd}$全为蓝色, 则已有$bcd$为蓝色$K_3$.
若$\textcolor{red}{de}$为红色, 则可设
$\textcolor{blue}{df}$为蓝色(否则$def$为红色$K_3$), 又可设$\textcolor{red}{bf}$为红色(否则$bdf$为蓝色$K_3$), 又可设$\textcolor{blue}{be}$为蓝色(否则$bef$为红色$K_3$), 又可设$\textcolor{red}{ce}$为红色(否则$bce$为蓝色$K_3$), 则不论$cf$为什么颜色, 都得到另一个同色$K_3$ (红色$cef$或蓝色$cdf$).
若$\textcolor{blue}{de}$为蓝色, 则可设
$\textcolor{red}{be}$为红色(否则$bde$为蓝色$K_3$), 又可设$\textcolor{blue}{bf}$为蓝色(否则$bef$为红色$K_3$), 又可设$\textcolor{red}{cf}$为红色(否则$bcf$为蓝色$K_3$), 则不论$ce$为什么颜色, 都得到另一个同色$K_3$ (红色$cef$或蓝色$cde$).

\par \textbf{20}. 证明: $r(3,3,3)\le 17$.
\par 证明: 考虑$K_{17}$边的红黄蓝三染色, 任取一个顶点$a$, 考虑其引出的16条边, 其中必有6条边同色, 不妨设有6条红边. 考虑这些边连接的6个顶点, 若其中有红边, 则其两端点和$a$构成红色$K_3$; 若不然, 它们构成的$K_6$中只有黄边和蓝边, 其中必有黄色或蓝色$K_3$($r(3,3)=6$).

\par \textbf{23}. 证明: $r(3,4)\le 10$.
\par 证明: 考虑$K_{10}$边的红蓝二染色, 往证或者有红色$K_3$, 或者有蓝色$K_4$. 假设不存在红色$K_3$, 任取一个顶点$a$, 考虑其引出的9条边. 若有4条红边, 则这些边连接的4个顶点构成蓝色$K_4$. 若不然, 至少有6条蓝边, 其连接的6 个顶点中必有蓝色$K_3$($r(3,3)=6$, 又由假设没有红色$K_3$), 加上$a$ 即得蓝色$K_4$.

\section{生成排列和组合}
\par \textbf{5}. 设$i_1 i_2\cdots i_n$是$\{1,2,\cdots,n\}$ 的排列, 且它的逆序数为$k$. 证明不能通过少于$k$次连续交换相邻两项将其变为$12\cdots n$.
\par 证明: 将一个$\{1,2,\cdots,n\}$ 的排列的相邻两项$ij$ 变为$ji$时, 若$i<j$, 逆序列中只有$i$对应的项$b_i$增加$1$; 若$i>j$, 逆序列中只有$j$对应的项$b_j$减少$1$. 故每次交换相邻两项恰使排列的逆序数改变$1$, 从而$i_1 i_2\cdots i_n$ 至少要$k$次交换相邻两项才能变为$12\cdots n$.

\par \textbf{37}. 令$R_1,R_2$为$X$上的两个偏序关系, 定义$R_1$ 与$R_2$的交$R$, $xRy$当且仅当$xR_1y$, $xR_2y$ 同时成立. 证明: $R$也是$X$上的偏序关系.
\par 证明: 自反性: $\forall x \in X$, 由$xR_1x, xR_2x$, 得$xRx$; 反对称性: $\forall x,y \in X$, 若$xRy, yRx$, 得$xR_1y, yR_1x$, 知$x=y$; 传递性: $\forall x,y,z \in X$, 若$xRy, yRz$, 则$xR_1y, yR_1z$推出$xR_1z$, $xR_2y, yR_2z$ 推出$xR_2z$, 故$xRz$.

\par \textbf{38}. 设$(X_i,\le_i),1\le i\le n$是$n$个偏序集, 在$X=X_1\times X_2 \times \cdots\times X_n$上定义关系$T:(x_1,x_2,\cdots,x_n)T(y_1,y_2,\cdots,y_n)$ 当且仅当$x_i\le_i y_i$ 对$\forall 1\le i\le n$成立. 证明: $(X_1\times X_2 \times \cdots\times X_n, T)$ 是偏序集, 称为这$n$个偏序集的直积.
\par 证明:
\par (1)自反性: $\forall (x_1,x_2,\cdots,x_n) \in X$, 由$x_i\le_i x_i, \forall 1\le i\le n$, 得
\begin{displaymath}
(x_1,x_2,\cdots,x_n)T(x_1,x_2,\cdots,x_n).
\end{displaymath}
\par (2)反对称性: $\forall (x_1,x_2,\cdots,x_n),(y_1,y_2,\cdots,y_n) \in X$, 若
\begin{displaymath}
(x_1,x_2,\cdots,x_n)T (y_1,y_2,\cdots,y_n),
(y_1,y_2,\cdots,y_n)T (x_1,x_2,\cdots,x_n)
\end{displaymath}
得
\begin{displaymath}
x_i \le_i y_i, y_i \le_i x_i, \forall 1\le i\le n
\end{displaymath}
知$x_i = y_i,\forall 1\le i\le n$;
\par (3)传递性: $\forall(x_1,x_2,\cdots,x_n),(y_1,y_2,\cdots,y_n),(z_1,z_2,\cdots,z_n) \in X$, 若
\begin{displaymath}
(x_1,x_2,\cdots,x_n)T(y_1,y_2,\cdots,y_n), (y_1,y_2,\cdots,y_n)T(z_1,z_2,\cdots,z_n)
\end{displaymath}
则$x_i\le_iy_i, y_i\le_iz_i$ 推出$x_i\le_iz_i,\forall 1\le i\le n$. 故$(x_1,x_2,\cdots,x_n)T(z_1,z_2,\cdots,z_n)$.

\par \textbf{49}. 令$R,S$为$X$上的两个等价关系. 证明: $T=R\cap S$ 也是$X$上的等价关系.
\par 证明: 自反性: $\forall x\in X$, 由$xRx, xSx$, 得$xTx$; 对称性: $\forall x,y \in X$, 若$xTy$, 得$xRy, xSy$, 知$yRx, ySx$, 故$yTx$; 传递性: $\forall x,y,z \in X$, 若$xTy, yTz$, 则$xRy, xSy$, $yRz, ySz$推出$xRz, xSz$, 故$xTz$.

\section{二项式系数}

\par \textbf{10}. 设$n,k$是正整数, 用组合推理证明
\begin{displaymath}
k\binom{n}{k}=n\binom{n-1}{k-1}
\end{displaymath}
\par 证明: 考虑如下情景: 从$n$名学生中选$k$ 名组成一个小组, 并从中选出一名组长, 方法数为$k\binom{n}{k}$; 为达到同样的结果, 也可以先从$n$名学生中选出组长, 再从剩下的$n-1$ 名同学中选出$k-1$名普通组员, 方法数为$n\binom{n-1}{k-1}$.

\par \textbf{12}. 设$n$是正整数, 证明
\begin{displaymath}
\sum^{n}_{k=0}(-1)^{k}\binom{n}{k}^2=
\begin{cases}
0,& n\text{是奇数}\\
(-1)^m\binom{2m}{m}, & n=2m
\end{cases}
\end{displaymath}
\par 证明: 当$n=2m+1,m\in\mathbb{N}$, 有
\begin{align*}
\sum^{n}_{k=0}(-1)^{k}\binom{n}{k}^2
&=\sum^{m}_{k=0}((-1)^{k}\binom{n}{k}^2+(-1)^{n-k}\binom{n}{n-k}^2)\notag\\
&=\sum^{m}_{k=0}(-1)^{k}(\binom{n}{k}^2-\binom{n}{n-k}^2)\notag\\
&=0. \notag
\end{align*}
当$n=2m,m\in\mathbb{N}^*$, 考虑
\begin{displaymath}
(1-x^2)^n=(1+x)^n(1-x)^n
\end{displaymath}
中$x^n=x^{2m}$的系数. 左边为
\begin{displaymath}
(-1)^m\binom{2m}{m},
\end{displaymath}
右边为
\begin{displaymath}
\sum_{k=0}^n\binom{n}{k}(-1)^{n-k}\binom{n}{n-k}=
\sum_{k=0}^n(-1)^{k}\binom{n}{n-k}^2.
\end{displaymath}

\par \textbf{16}. 设$n$是正整数, 通过对二项展开式积分证明
\begin{displaymath}
\sum_{k=0}^n \frac{1}{k+1}\binom{n}{k}=\frac{2^{n+1}-1}{n+1}.
\end{displaymath}
\par 证明: 由二项式定理
\begin{displaymath}
(1+x)^n=\sum_{k=0}^n\binom{n}{k}x^k
\end{displaymath}
从0到x积分得
\begin{displaymath}
\frac{1}{n+1}((1+x)^{n+1}-1)
=\sum_{k=0}^n\frac{1}{k+1}\binom{n}{k}x^{k+1}
\end{displaymath}
令$x=1$即得待证等式.

\par \textbf{17}. 设$n$是正整数, 用组合恒等式证明
\begin{displaymath}
\sum_{k=0}^n \frac{1}{k+1}\binom{n}{k}=\frac{2^{n+1}-1}{n+1}.
\end{displaymath}

\par 证明: 由
\begin{displaymath}
k\binom{n}{k}=n\binom{n-1}{k-1}
\end{displaymath}
可得
\begin{displaymath}
\frac{1}{n+1}\binom{n+1}{k+1}=\frac{1}{k+1}\binom{n}{k}
\end{displaymath}
故
\begin{align*}
\sum_{k=0}^n \frac{1}{k+1}\binom{n}{k}
&=\frac{1}{n+1}\sum^{n}_{k=0}\binom{n+1}{k+1}\notag\\
&=\frac{1}{n+1}\sum^{n+1}_{k=1}\binom{n+1}{k}\notag\\
&=\frac{1}{n+1}(\sum^{n+1}_{k=0}\binom{n+1}{k}-1)\notag\\
&=\frac{2^{n+1}-1}{n+1}. \notag
\end{align*}

\par \textbf{22}. 设$r\in\mathbb{R},k,m\in\mathbb{Z}$, 证明
\begin{displaymath}
\binom{r}{m}\binom{m}{k}=\binom{r}{k}\binom{r-k}{m-k}.
\end{displaymath}
\par 证明: 当$k<0$, $\binom{m}{k}=\binom{r}{k}=0$;
当$k=0$, 上式为$\binom{r}{m}=\binom{r}{m}$; 下设$k>0$.
当$m<k$, $\binom{m}{k}=\binom{r-k}{m-k}=0$;
当$m=k$, 上式为$\binom{r}{m}=\binom{r}{k}$; 下设$m>k$.
此时有
\begin{align*}
\binom{r}{m}\binom{m}{k}
&=\frac{r(r-1)\cdots(r-m+1)}{m!}\frac{m!}{k!(m-k)!}\notag\\
&=\frac{r(r-1)\cdots(r-m+1)}{k!(m-k)!}\notag\\
&=\frac{r(r-1)\cdots(r-k+1)}{k!}\frac{(r-k)(r-k-1)\cdots(r-m+1)}{(m-k)!}\notag\\
&=\binom{r}{k}\binom{r-k}{m-k}. \notag
\end{align*}

\par \textbf{27}. 设$n,k$是正整数, 用组合推理证明
\begin{displaymath}
n(n+1)2^{n-2}=\sum_{k=1}^n k^2\binom{n}{k}
\end{displaymath}
\par 证明: 考虑如下情景: 从$n$名学生中选出一个小组, 并从中选出一名组长和一名支部书记(可由一人兼任). 对小组人数分类, 当小组有$k$ 人时, 方法数为$k^2\binom{n}{k}$, 得右边的结果; 为达到同样的结果, 也可以分组长和支部书记是否为同一人讨论: 若为同一人, 先从$n$名学生中选出组长, 再确定剩下的$n-1$名同学是否加入小组, 方法数为$n2^{n-1}$; 若不为同一人, 先从$n$名学生中选出组长和支部书记, 再确定剩下的$n-2$名同学是否加入小组, 方法数为$n(n-1)2^{n-2}$, 二者之和为$n(n+1)2^{n-2}$, 得右边的结果.

\par \textbf{28}. 设$n,k$是正整数, 用组合推理证明
\begin{displaymath}
\sum_{k=1}^{n} k\binom{n}{k}^2=n\binom{2n-1}{n-1}
\end{displaymath}
\par 证明: 考虑如下情景: 有$2n$名爱好舞蹈的学生, 男女各$n$ 人, 从中选出$n$人成立舞蹈队, 并从女生中选出一名队长. 按队中女生人数分类$(1\le k\le n)$, 当女生有$k$人时, 方法数为$k\binom{n}{k}\binom{n}{n-k}$, 得左边的结果; 为达到同样的结果, 也可以先选出队长, 再从剩下的$2n-1$名同学中选出$n-1$人进队, 方法数为$n\binom{2n-1}{n-1}$, 得右边的结果.

\par \textbf{30}. 设$S=\{1,2,3,4\}$, 其幂集在包含关系下成一偏序集. 证明其大小为6的唯一反链是所有2子集的集合.
\par 证明: 考虑$S$的对称链划分
\begin{align*}
&\varnothing\subset\{1\}\subset\{1,2\}\subset\{1,2,3\}\subset\{1,2,3,4\}\notag\\
&\{4\}\subset\{1,4\}\subset\{1,2,4\}\notag\\
&\{2\}\subset\{2,3\}\subset\{2,3,4\}\notag\\
&\{3\}\subset\{1,3\}\subset\{1,3,4\}\notag\\
&\{2,4\}\notag\\
&\{3,4\}.\notag
\end{align*}
知其反链最大大小为6, 且必须从6个链中各取1 个. 现$\{2,4\}\{3,4\}$ 已取, 以上第二、三、四个链也只能取2子集,
最后知第一个链中也只能取2子集.

\par \textbf{43}. 对$z\in (-1,1)$, 假设
\begin{displaymath}
\frac{1}{1-z}=\sum_{k=0}^\infty z^k,
\end{displaymath}
用归纳法证明
\begin{displaymath}
\frac{1}{(1-z)^n}=\sum_{k=0}^\infty \binom{n+k-1}{k}z^k,
\end{displaymath}
\par 证明: 设上式对$n$ 成立, 考虑$n+1$的情形:
\begin{align*}
\frac{1}{(1-z)^{n+1}}
&=\frac{1}{(1-z)^n}\frac{1}{1-z}\notag\\
&=\sum_{k=0}^\infty \binom{n+k-1}{k}z^k \sum_{l=0}^\infty z^l\notag\\
&=\sum_{m=0}^\infty z^m \sum_{k=0}^m \binom{n+k-1}{k}\notag\\
&=\sum_{m=0}^\infty z^m \binom{n+m}{m}\notag\\
&=\sum_{k=0}^\infty z^k \binom{n+1+k-1}{k}. \notag
\end{align*}

\par \textbf{48}. 设$m,n$是正整数, 证明$mn+1$元偏序集$S$ 有一个大小为$m+1$的链或大小为$n+1$的反链.
\par 证明: 设$S$最大链长度为$k$, 若$k\ge m+1$结论已成立. 若$k\le m$, $S$可划分为$k$个反链, 根据抽屉原理至少存在一个反链大小不小于$n+1$.

\par \textbf{49}. 证明$mn+1$个实数的序列或者有长度为$m+1$ 的递增子序列, 或者有长度为$n+1$的递减子序列.
\par 证明: 在$\{(i,a_i)|1\le i\le mn+1\}$上定义偏序$R$, $(j,a_j)R(k,a_k)$当且仅当$j\le k$且$a_j\le a_k$, 则递增子序列与链对应, 递减子序列与反链对应. 由上一题结论即得证.

\par \textbf{50}. 设$X=\{1,2,3,\cdots,12\}$, 其在整除关系下成一偏序集. (1)确定最大链和将$X$划分成最小数目的反链的划分. (2)确定最大反链和将$X$划分成最小数目的链的划分.
\par 解: (1)考虑$X$的反链划分
\begin{displaymath}
\{1\},\{2,3,5,7,11\},\{4,6,9,10\},\{8,12\}
\end{displaymath}
知最大链长度至多为4; 而$\{1,2,4,8\}$是一个长为4的链, 故上述划分为最小数目的反链划分.
\par (2)考虑$X$的链划分
\begin{displaymath}
\{1,2,4,8\},\{3,6,12\},\{5,10\},\{7\},\{9\},\{11\}
\end{displaymath}
知最大反链长度至多为6; 而$\{4,5,6,7,9,11\}$是一个长为6的反链, 故上述划分为最小数目的链划分.

\section{容斥原理及应用}
\par \textbf{16}. 用组合推理证明
\begin{displaymath}
n!=\sum_{i=0}^n \binom{n}{i}D_{n-i}
\end{displaymath}
\par 证明: 考虑$\{1,2,3,\cdots,n\}$的全部$n!$个排列, 按相对于自然排列$123\cdots n$不动点个数$i$分类$(0\le i\le n)$, 恰有$i$个不动点时的排列数为$\binom{n}{i}D_{n-i}$.

\par \textbf{19}. 证明
\begin{displaymath}
D_n=(n-1)(D_{n-2}+D_{n-1})
\end{displaymath}
\par 证明:
\begin{align*}
&(n-1)(D_{n-2}+D_{n-1})\notag\\
=&(n-1)((n-2)!\sum_{k=0}^{n-2}(-1)^k\frac{1}{k!}+
(n-1)!\sum_{k=0}^{n-1}(-1)^k\frac{1}{k!})\notag\\
=&(n-1)(n(n-2)!\sum_{k=0}^{n-2}(-1)^k\frac{1}{k!}+
(n-1)!(-1)^{n-1}\frac{1}{(n-1)!})\notag\\
=&n!\sum_{k=0}^{n-2}(-1)^k\frac{1}{k!}+(-1)^{n-1}(n-1)\notag\\
=&n!\sum_{k=0}^{n}(-1)^k\frac{1}{k!}\notag\\
=&D_n. \notag
\end{align*}

\par \textbf{21}. 证明$D_n$是偶数当且仅当$n$是奇数.
\par 证明: 我们有
\begin{displaymath}
D_n=nD_{n-1}+(-1)^n
\end{displaymath}
以下对n归纳证明$D_{2n-1}$是偶数且$D_{2n}$是奇数. $n=1$ 时由$D_1=0,D_2=1$成立. 设$D_{2n-1}$是偶数, $D_{2n}$是奇数, 则$D_{2n+1}=(2n+1)D_{2n}-1$是偶数, $D_{2n+2}=(2n+2)D_{2n+1}+1$是奇数.

\section{递推关系和生成函数}

\section{特殊计数序列}

\section{相异代表系}

\section{组合设计}

\section{图论导引}

\section{再论图论}

\section{有向图与网络}

\section{$P\acute{o}lya$ 计数}

\end{CJK*}
\end{document}

